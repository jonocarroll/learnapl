
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Direct functions and operators &#8212; Learning APL</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Iteration" href="iteration.html" />
    <link rel="prev" title="Glyphiary" href="manip.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo2.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learning APL</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="array.html">
   It’s arrays all the way down
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="indexing.html">
   Indexing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="manip.html">
   Glyphiary
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Direct functions and operators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="key.html">
   The Key operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⌸
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="at.html">
   The At operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     @
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rank.html">
   The Rank/Atop operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍤
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="stencil.html">
   The Stencil operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⌺
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="over.html">
   The Över operator:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍥
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dyadictrn.html">
   Dyadic transpose:
   <code class="docutils literal notranslate">
    <span class="pre">
     A⍉B
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="decode.html">
   Encode decode:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⊤⊥
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="products.html">
   Products
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tacit.html">
   Trainspotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="find.html">
   Finding things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="cookbook1.html">
   Partitions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="errors.html">
   Error handling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="aplway.html">
   The APL Way
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="namespaces.html">
   Namespaces
   <code class="docutils literal notranslate">
    <span class="pre">
     ⎕NS
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="io.html">
   Dealing with real data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="http.html">
   HttpCommand
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dfnsws.html">
   The dfns workspace
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="testing.html">
   Testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="workflow.html">
   A Dyalog workflow. Or two.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="next.html">
   What now?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="tldr.html">
   Too long; didn’t read
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/xpqz/learnapl"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/xpqz/learnapl/issues/new?title=Issue%20on%20page%20%2Ffunctions.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/functions.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#left-and-right-arguments">
   Left and right arguments:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍺
    </span>
   </code>
   ,
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍵
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#default-left-argument">
   Default left argument
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternation">
   Alternation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modified-assignment">
   Modified Assignment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#direct-operators">
   Direct operators
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Direct functions and operators</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#left-and-right-arguments">
   Left and right arguments:
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍺
    </span>
   </code>
   ,
   <code class="docutils literal notranslate">
    <span class="pre">
     ⍵
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#default-left-argument">
   Default left argument
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternation">
   Alternation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modified-assignment">
   Modified Assignment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#direct-operators">
   Direct operators
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="direct-functions-and-operators">
<h1>Direct functions and operators<a class="headerlink" href="#direct-functions-and-operators" title="Permalink to this headline">#</a></h1>
<blockquote>
<div><p>I made up the term “object-oriented,” and I can tell you I did not have C++ in mind.
–<em>Alan Kay</em></p>
</div></blockquote>
<p>Until now, we’ve mainly used APL as a toolkit for array manipulation using its built-in primitives. Sure, it goes a long way, but to fully take advantage of it, we also need to be able to create our own functions and operators. Fortunately, the syntax – if we can even call it that – for user-defined functions, is super-simple. As someone said on the APL Orchard chat room, all you need to do is “slap curly braces around your code, and you’re done”. It’s not <em>quite</em> that simple, but not too far off.</p>
<p>The definition of a <em>dfn</em> (direct function) is enclosed in a pair of curly braces. It’s what’s known as an anonymous function, or a lambda, in other languages, meaning that there is no syntactic sugar for naming a function beyond ordinary assignment using <em>Gets</em>, <code class="docutils literal notranslate"><span class="pre">←</span></code>:</p>
<div class="highlight-apl notranslate"><div class="highlight"><pre><span></span><span class="nv">name</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"> </span>
<span class="w">   </span><span class="c1">⍝ expressions</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
<p>First a bit of unavoidable <a class="reference external" href="https://xkcd.com/349/">yak shaving</a>: if a dfn fits entirely on a single line, you can type it out directly in the RIDE IDE. So far, so expected. If your dfn extends across multiple lines, you can’t (at the time of writing) just type it in. Dyalog is working on enhancing this.</p>
<p>Instead, the most convenient way to enter such a function is to say</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>)ed name
</pre></div>
</div>
<p>if you want to create a function called <code class="docutils literal notranslate"><span class="pre">name</span></code>. RIDE will open its function editor and let you enter your code there. Once you want to test your function, you first need to save it, which in APL-speak is called “to fix your function”. The default way (and you’re unlikely to ever discover this by yourself) to fix (save) your function is to hit <kbd>esc</kbd>. Yes, really. Fortunately – and I recommend you do so right now – RIDE allows you to re-bind keystrokes by clicking on the little keyboard symbol in the top-right corner.</p>
<p>Locate the row that says “Fix the current function” and map that to the key combo that is <code class="docutils literal notranslate"><span class="pre">save</span></code> on your platform. And whilst you’re there, make a note of the keys binding to “Forward” and “Backward” – they default to <kbd>ctrl-shift-enter</kbd> and <kbd>ctrl-shift-backspace</kbd>. In the REPL, these mean forward/back in the history of executed lines, like the arrow keys in the shell. The arrow keys instead move up and down spatially, in the <em>output</em>, still, to me an incomprehensible design decision. You might also want to rebind “Strong interrupt” to <kbd>ctrl-c</kbd> while you’re at it.</p>
<p>The other thing to note is that in RIDE there is no visual cue that an editor window contains unsaved changes. This is sure to bite you sooner or later.</p>
<p>In a Jupyter notebook, like here, entering functions might feel a bit more familiar: just type them into a cell. The only quirk is that in order to enter a multi-line dfn, you need to start the cell with <code class="docutils literal notranslate"><span class="pre">]dinput</span></code> (which isn’t needed in a RIDE edit window). You <em>can</em> actually use the <code class="docutils literal notranslate"><span class="pre">]dinput</span></code> way of entering a multi-line function in the interpreter REPL, too, but (in my opinion) it’s rather cumbersome unless you’re just cutting and pasting from somewhere else. In the upcoming (at the time of writing) version 18.1 there is experimental support for being able to type in multi-line functions directly in the REPL, similar to how that works in Python’s REPL.</p>
<p>First, our now familiar prelude:</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nf">⎕IO</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="sr">]</span><span class="nv">box</span><span class="w"> </span><span class="nv">on</span><span class="w"></span>
<span class="sr">]</span><span class="nv">rows</span><span class="w"> </span><span class="nv">on</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">Was ON
</pre></div><div class="output text_html"><pre class="language-APL">Was OFF
</pre></div></div>
</div>
<p>We’re also going to make some assertions, so let’s have a helper function for that, courtesy of APL legend Roger Hui (and not speculating on its inner workings for now):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">assert</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="s1">&#39;assertion failure&#39;</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="m">0</span><span class="o">∊</span><span class="bp">⍵:</span><span class="w"> </span><span class="bp">⍺</span><span class="w"> </span><span class="nf">⎕signal</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="nv">shy</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<section id="left-and-right-arguments">
<h2>Left and right arguments: <code class="docutils literal notranslate"><span class="pre">⍺</span></code>, <code class="docutils literal notranslate"><span class="pre">⍵</span></code><a class="headerlink" href="#left-and-right-arguments" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">MyFirstFunction</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ Add left and right</span><span class="w"></span>
<span class="w">    </span><span class="bp">⍺</span><span class="o">+</span><span class="bp">⍵</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">32</span><span class="w"> </span><span class="nv">MyFirstFunction</span><span class="w"> </span><span class="m">98</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">130
</pre></div></div>
</div>
<p>The first thing to note is the glyphs <code class="docutils literal notranslate"><span class="pre">⍺</span></code> and <code class="docutils literal notranslate"><span class="pre">⍵</span></code>; the Greek letters alpha and omega. Alpha, the first letter of the Greek alphabet, is bound to the function’s left argument, and omega, the last letter of the Greek alphabet, is bound to the function’s right argument.</p>
<p>The second thing to learn is that APL expressions are separated by newline (or the diamond glyph, <code class="docutils literal notranslate"><span class="pre">⋄</span></code> which we’ll get to later). We could rewrite the above function to use an intermediate variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Sum</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ Add left and right</span><span class="w"></span>
<span class="w">    </span><span class="nv">total</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="bp">⍺</span><span class="o">+</span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">total</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">32</span><span class="w"> </span><span class="nv">Sum</span><span class="w"> </span><span class="m">98</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">130
</pre></div></div>
</div>
<p>The third thing is that there is no “return” statement. The function returns the first non-assigned value. It’s worth letting this sink in: a function returns at the first point you do anything that isn’t an assignment. In the function above, the return point is us just stating the variable <code class="docutils literal notranslate"><span class="pre">total</span></code>.</p>
</section>
<section id="default-left-argument">
<h2>Default left argument<a class="headerlink" href="#default-left-argument" title="Permalink to this headline">#</a></h2>
<p>A useful feature is that you can set a default value for the left argument, <code class="docutils literal notranslate"><span class="pre">⍺</span></code>. Compare:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="kt">{</span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯99</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="bp">⍺</span><span class="o">+</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"> </span><span class="m">99</span><span class="w"></span>
<span class="m">57</span><span class="w"> </span><span class="kt">{</span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯99</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="bp">⍺</span><span class="o">+</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"> </span><span class="m">99</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">0
</pre></div><div class="output text_html"><pre class="language-APL">156
</pre></div></div>
</div>
<p>This way a function can behave in different ways depending on if it is called monadically or dyadically. If you give a value to <code class="docutils literal notranslate"><span class="pre">⍺</span></code> with <code class="docutils literal notranslate"><span class="pre">←</span></code>, then <code class="docutils literal notranslate"><span class="pre">⍺</span></code> will have this value if you didn’t pass a left argument to the function. On the other hand, if you <em>do</em> pass a left argument, the “alpha gets” line has no effect. When defaulting the left argument this way, note that this only works for the <em>first</em> time you give a value to alpha, which is perhaps obvious when you think of it:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="kt">{</span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯99</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">¯999999</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="bp">⍺</span><span class="o">+</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"> </span><span class="m">99</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">0
</pre></div></div>
</div>
<p>Setting a default value for the left argument is a useful tool if you write recursive dfns, which typically accumulate their result on the left argument. This way you can call the function monadically to start, but subsequent iterations can use the left argument to build up the result. We’ll talk more about recursion later in the chapter on <a class="reference internal" href="iteration.html"><span class="doc std std-doc">iteration techniques</span></a>, but here’s a taster to demonstrate the default left argument technique. The glyph <em>Del</em> (<code class="docutils literal notranslate"><span class="pre">∇</span></code>) is a reference to the innermost function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">sum</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="w">       </span><span class="c1">⍝ Initialise the accumulator</span><span class="w"></span>
<span class="w">    </span><span class="m">0</span><span class="o">=≢</span><span class="bp">⍵:⍺</span><span class="w">      </span><span class="c1">⍝ If right arg empty vector, return accumulator, see below!</span><span class="w"></span>
<span class="w">    </span><span class="p">(</span><span class="bp">⍺</span><span class="o">+⊃</span><span class="bp">⍵</span><span class="p">)</span><span class="bp">∇</span><span class="m">1</span><span class="o">↓</span><span class="bp">⍵</span><span class="w">  </span><span class="c1">⍝ Add head to accumulator, recurse over tail</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sum</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
<span class="m">100</span><span class="w"> </span><span class="nv">sum</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">45
</pre></div><div class="output text_html"><pre class="language-APL">145
</pre></div></div>
</div>
</section>
<section id="alternation">
<h2>Alternation<a class="headerlink" href="#alternation" title="Permalink to this headline">#</a></h2>
<p>What about alternation? We got a brief view of a conditional return in the example just above – a <a class="reference external" href="https://help.dyalog.com/latest/#Language/Defined%20Functions%20and%20Operators/DynamicFunctions/Guards.htm"><em>guard statement</em></a>. Recall that there is no if-statement for us. A <em>guard</em>, defined with a colon, says, if the expression to the left of the colon is true, return from the function with the value to the right of the colon. A contrived example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">Palinish</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">rev</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⊖</span><span class="bp">⍵</span><span class="w"> </span><span class="c1">⍝ Reverse the right arg</span><span class="w"></span>
<span class="w">    </span><span class="nv">rev</span><span class="o">≡</span><span class="bp">⍵:</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c1">⍝ If right arg matches its own reverse, return 1</span><span class="w"></span>
<span class="w">    </span><span class="m">0</span><span class="w">        </span><span class="c1">⍝ Else, return 0</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">Palinish</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="nv">Palinish</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">5</span><span class="w"></span>
<span class="nv">Palinish</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">1
</pre></div><div class="output text_html"><pre class="language-APL">0
</pre></div><div class="output text_html"><pre class="language-APL">1
</pre></div></div>
</div>
<p>For the avoidance of doubt, we could of course have written that as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="kt">{</span><span class="bp">⍵</span><span class="o">≡⊖</span><span class="bp">⍵</span><span class="kt">}</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c1">⍝ Anonymous (unnamed) version</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">1
</pre></div></div>
</div>
<p>Note that execution flow does <em>not</em> carry on after a guard expression, even if that was an assignment. This requires some thought when writing code that needs to conditionally “do something” and then carry on, as illustrated in the following meaningless Python-like snippet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
    <span class="n">fum</span> <span class="o">=</span> <span class="mi">57</span>
    <span class="n">fee</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="k">if</span> <span class="n">flerp</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">47</span><span class="p">:</span>
        <span class="n">fee</span> <span class="o">=</span> <span class="mi">92</span>
        <span class="n">fum</span> <span class="o">=</span> <span class="n">flumm</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fee</span> <span class="o">+</span> <span class="n">fum</span>
</pre></div>
</div>
<p>Actually, we can turn that into APL trivially, using only what we already know:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="m">47</span><span class="o">&gt;</span><span class="nv">flerp</span><span class="w"> </span><span class="bp">⍵:</span><span class="w"> </span><span class="m">92</span><span class="o">+</span><span class="nv">flumm</span><span class="w"> </span><span class="bp">⍵</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="m">57</span><span class="o">+</span><span class="m">8</span><span class="kt">}</span><span class="w"> </span><span class="c1">⍝ Note: diamond separator</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>Let’s investigate some possible patterns for achieving a flow where execution carries on following an “if-then-else” branch. On way is to use an anonymous function, in essence like Python’s</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">42</span> <span class="k">if</span> <span class="n">answer</span> <span class="k">else</span> <span class="o">-</span><span class="mi">99</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">answer</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="bp">⍵:</span><span class="m">42</span><span class="w"> </span><span class="p">⋄</span><span class="w"> </span><span class="m">¯99</span><span class="kt">}</span><span class="w"> </span><span class="nv">answer</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ ...execution follows here</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ do something with a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>In this case, as <code class="docutils literal notranslate"><span class="pre">answer</span></code> is a boolean, we could have avoided the inner function entirely by simply picking the values from a 2-element vector (note: need <code class="docutils literal notranslate"><span class="pre">⎕IO←0</span></code> for this to work):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="nf">⎕IO</span><span class="kd">←</span><span class="m">0</span><span class="w"></span>
<span class="w">    </span><span class="nv">answer</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="bp">⍵</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">answer</span><span class="o">⊃</span><span class="m">¯99</span><span class="w"> </span><span class="m">42</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ ...execution follows here</span><span class="w"></span>
<span class="w">    </span><span class="c1">⍝ do something with a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>With the first technique (the anonymous function) we have scope to extend the work done in each branch by making the function more complex, but ultimately it still returns a value. What if we need to modify multiple values? We could of course return an array of things, that’s a perfectly valid approach.</p>
<p>Name scoping rules in Dyalog are a mixture between dynamic and lexical scope. Here’s what Dyalog’s <a class="reference external" href="http://help.dyalog.com/latest/index.htm#Language/Defined%20Functions%20and%20Operators/DynamicFunctions/Static%20Name%20Scope.htm">docs</a> say about it:</p>
<blockquote>
<div><p>When an inner (nested) dfn refers to a name, the interpreter searches for it by looking outwards through enclosing dfns, rather than searching back along the state indicator.</p>
</div></blockquote>
<p>Lexical scope is almost certainly “what you expect”. However, as Dyalog has no dedicated syntax for declaring a variable beyond giving it a value, if you need to modify a variable not introduced in the innermost dfn, we need a way to indicate this.</p>
<p>Consider the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">45</span><span class="w"></span>
<span class="w">    </span><span class="nv">_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="nv">a</span><span class="kd">←</span><span class="m">¯99</span><span class="kt">}</span><span class="no">⍬</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">foo</span><span class="w"> </span><span class="no">⍬</span><span class="w"> </span><span class="c1">⍝ Note: 45, not ¯99</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">45
</pre></div></div>
</div>
<p>The innermost function creates a <em>new</em> variable with lexical scope, with the name <em>a</em>. So how <em>do</em> you modify state defined outside a function? This is where <em>modified assignment</em> comes in.</p>
</section>
<section id="modified-assignment">
<h2>Modified Assignment<a class="headerlink" href="#modified-assignment" title="Permalink to this headline">#</a></h2>
<p><a class="reference external" href="https://help.dyalog.com/latest/#Language/Primitive%20Operators/Assignment%20Modified.htm"><em>Modified assignment</em></a> should feel familiar to any C or Python programmers amongst you:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modified assignment, Python-style</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">a</span> <span class="o">+=</span> <span class="mi">45</span> <span class="c1"># a is now 90</span>
</pre></div>
</div>
<p>In APL, we can also modify an existing variable’s value via a function, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">45</span><span class="w"></span>
<span class="w">    </span><span class="nv">_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="nv">a</span><span class="w"> </span><span class="o">+</span><span class="kd">←</span><span class="w"> </span><span class="m">45</span><span class="kt">}</span><span class="no">⍬</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="no">⍬</span><span class="w"></span>
<span class="nv">assert</span><span class="w"> </span><span class="nv">r</span><span class="o">=</span><span class="m">90</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">90
</pre></div></div>
</div>
<p>The supremely useful, but perhaps non-intuitive kicker: you can use modified assignment with <em>Right tack</em> (<code class="docutils literal notranslate"><span class="pre">⊢</span></code>) to <em>set</em> values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">45</span><span class="w"></span>
<span class="w">    </span><span class="nv">_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="nv">a</span><span class="w"> </span><span class="o">⊢</span><span class="kd">←</span><span class="w"> </span><span class="m">¯99</span><span class="kt">}</span><span class="no">⍬</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="no">⍬</span><span class="w"></span>
<span class="nv">assert</span><span class="w"> </span><span class="nv">r</span><span class="o">=</span><span class="m">¯99</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">¯99
</pre></div></div>
</div>
<p>We’ve already met a bunch of <a class="reference external" href="http://help.dyalog.com/latest/Content/Language/Primitive%20Functions/Assignment%20Selective.htm#SelectiveAssignment">selectable assignment</a> expressions when we talked about <a class="reference internal" href="indexing.html"><span class="doc std std-doc">indexing</span></a>. We can use all of those here. For example, we can mutate cells in a matrix using bracket indexing:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foo</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="c1">⍝ 3×3 matrix of all 1</span><span class="w"></span>
<span class="w">    </span><span class="nv">_</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="nv">a</span><span class="sr">[</span><span class="m">1</span><span class="sr">;</span><span class="m">1</span><span class="sr">]</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="m">0</span><span class="kt">}</span><span class="no">⍬</span><span class="w"></span>
<span class="w">    </span><span class="nv">a</span><span class="w"></span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="vg">⎕</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="nv">foo</span><span class="w"> </span><span class="no">⍬</span><span class="w"></span>
<span class="nv">assert</span><span class="w"> </span><span class="nv">r</span><span class="o">≡</span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="o">⍴</span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">1 1 1
1 0 1
1 1 1
</pre></div></div>
</div>
</section>
<section id="direct-operators">
<h2>Direct operators<a class="headerlink" href="#direct-operators" title="Permalink to this headline">#</a></h2>
<p>We’ve met some of APL’s built-in operators already, like <em>Reduce</em> and <em>Selfie</em>. Operators are perhaps the closest APL gets to the functional programming paradigm. An <em>operator</em> is a function that returns a derived function. An operator can take other functions as its <em>operands</em>.</p>
<p>Consider <em>Reduce</em>, <code class="docutils literal notranslate"><span class="pre">/</span></code>. It’s a <em>monadic</em> operator that returns a derived function that can be called both monadically and dyadically:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="o">+</span><span class="na">/</span><span class="p">)</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"> </span><span class="c1">⍝ Parentheses not required, added for illustrative purposes</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">1 3 5 7 9 11 13 15 17
</pre></div></div>
</div>
<p>Here we see the monadic reduction operator, its sole operand being the plus function. The derived function it returns, plus-reduce, is called dyadically, with 2 to its left and <code class="docutils literal notranslate"><span class="pre">⍳10</span></code> to its right. In this case, a windowed reduction. We could have said</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="nv">sumred</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">+</span><span class="na">/</span><span class="w"></span>
<span class="m">2</span><span class="w"> </span><span class="nv">sumred</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">1 3 5 7 9 11 13 15 17
</pre></div></div>
</div>
<p>to emphasize the fact that the operator really returns a function.</p>
<p>Dyalog lets us write our own operators, too, in a very similar way to how we write dfns. We call our own operators <a class="reference external" href="https://help.dyalog.com/latest/#Language/Defined%20Functions%20and%20Operators/DynamicFunctions/Dynamic%20Operators.htm"><em>direct operators</em></a>, henceforth just <em>dops</em>. Operators can be powerful, but the need for them actually rarely arises in practice. The reason for this is that the built-in operators already let you apply your own functions in various ways.</p>
<p>A few things to note with operators:</p>
<ul class="simple">
<li><p>In a <em>dop</em>, <code class="docutils literal notranslate"><span class="pre">⍺⍺</span></code> represents the left operand, and <code class="docutils literal notranslate"><span class="pre">⍵⍵</span></code> is the right operand.</p></li>
<li><p>Unlike a monadic <em>dfn</em>, which takes a <em>right</em> argument, a monadic <em>dop</em> takes a <em>left</em> argument, like we just saw in the case of reduce.</p></li>
<li><p>The operator can refer to itself for recursion using <code class="docutils literal notranslate"><span class="pre">∇∇</span></code>, analogously to the dfn’s <code class="docutils literal notranslate"><span class="pre">∇</span></code>.</p></li>
</ul>
<p>Here’s an example monadic dop from the <a class="reference external" href="http://dfns.dyalog.com/n_foldl.htm">dfns</a> workspace, a left-to-right version of reduce:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="sr">]</span><span class="nv">dinput</span><span class="w"></span>
<span class="nv">foldl</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="kt">{</span><span class="w">                 </span><span class="c1">⍝ Fold (reduce) from the left.</span><span class="w"></span>
<span class="w">    </span><span class="bp">⍺</span><span class="w"> </span><span class="kd">←</span><span class="w"> </span><span class="o">⊃</span><span class="m">0</span><span class="o">⍴</span><span class="bp">⍵</span><span class="w">              </span><span class="c1">⍝ Default initial value for accumulator</span><span class="w"></span>
<span class="w">    </span><span class="o">↑</span><span class="bp">⍺⍺</span><span class="na">⍨/</span><span class="p">(</span><span class="o">⌽</span><span class="bp">⍵</span><span class="p">)</span><span class="o">,⊂</span><span class="bp">⍺</span><span class="w">        </span>
<span class="kt">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<p>This implements <code class="docutils literal notranslate"><span class="pre">foldl</span></code> in terms of the standard <code class="docutils literal notranslate"><span class="pre">foldr</span></code> by reversing the list and appending an accumulator element.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="o">+</span><span class="nv">foldl</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
<span class="o">+</span><span class="na">/</span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
<span class="o">-</span><span class="nv">foldl</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
<span class="o">-</span><span class="na">/</span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">45
</pre></div><div class="output text_html"><pre class="language-APL">45
</pre></div><div class="output text_html"><pre class="language-APL">¯45
</pre></div><div class="output text_html"><pre class="language-APL">¯5
</pre></div></div>
</div>
<p>This version takes an optional left argument that can be used to initialise the accumulator:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-APL notranslate"><div class="highlight"><pre><span></span><span class="m">99</span><span class="w"> </span><span class="o">+</span><span class="nv">foldl</span><span class="w"> </span><span class="o">⍳</span><span class="m">10</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre class="language-APL">144
</pre></div></div>
</div>
<p>Whilst there isn’t anything overly complex about writing your own operators as such, we probably won’t need to use many of them for the rest of this book, but at least now you have seen them.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "dyalog-kernel"
        },
        kernelOptions: {
            kernelName: "dyalog-kernel",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'dyalog-kernel'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="manip.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Glyphiary</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="iteration.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Iteration</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Stefan Kruger, Computational Array and Magic<br/>
  
    <div class="extra_footer">
      <p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" />
</a></p>
<p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p>

    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>